<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Reference guide for Citrix XenApp and XenDesktop SDK">
  
  
  <title>Citrix XenApp and XenDesktop SDK</title>
  

  <link rel="shortcut icon" href="
https://www.citrix.com/etc/designs/citrix/icon-favicon.png">

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="./css/theme.css" type="text/css" />
  <link rel="stylesheet" href="./css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="./css/highlight.css">
  <link rel="stylesheet" href="./css/override.css" type="text/css" />
  <link rel="stylesheet" href="./css/font-awesome.css" type="text/css" />

  
  <script>
    // Current page data
    var mkdocs_page_name = "None";
    var mkdocs_page_input_path = "index.md";
    var mkdocs_page_url = "/";
  </script>
  
  <script src="./js/jquery-2.1.1.min.js"></script>
  <script src="./js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="./js/highlight.pack.js"></script>
  <script src="./js/theme.js"></script>
  <script src="./js/custom.js"></script> 

  
</head>

<body class="wy-body-for-nav" role="document">

	<div class="header-top">
		<div class="header-top-left">
			<a href="http://www.citrix.com" class="logo-position"><img height="60" src="https://thumbnail-ec2.sharefile.com/thumbnail.aspx?encparams=ypL2J0l-In6gqXJ7yeyKP8A1rqwKMH-C8-nfkJcHJNIN7Y0yZiJsYOcUe-uc0YeZzWLQSFSd1FnuMHPa30XSSINHuGOA8nvvnBT5WmjGlKvd5mxJ4IfT7iTVyHELwhWQiNCznPCiIFyhkA78uKX77PlU2iyhM4YdRM1NKabBe-4wXuiFJsbtAxyJ2UukO_E2ZSf1W3l75Dw8G0zflVkT-EFqyx1zSGId0qzLjm6nzJ8dA9zo-1AJzUisdzmGMzHOq_LMsOWyaalvmcWvCkl-q10GBSbfekfTIFW9LpZNYjkLNSnK8rcwNjWVr_jYayrGjIj2e5dDIMiDj3NRvW51AvHRjxYH9xRRRtY$" target="_blank" class="logo-citrix"><span style="color:#fff;font-size: 20px;position: relative;top:4px;left: 5px">SDK Reference</span></a>
		</div>
		<div class="header-top-right">
			<ul>
			<!--	<li class="list-inline home"><a href=".">HOME</a></li>
				<li class="list-inline support"><a href="http://support.citrix.com">SUPPORT</a></li>-->
				<form id ="rtd-search-form" class="wy-form" action="./search.html" method="get">
            <li class="list-inline support"><input name="q" id="txtName" type="text" placeholder="Search SDKs" 
            class="searchdocs">
<a class="fa fa-search errspan"></a></li>
</form>
				<!--<li class="list-inline"><a href="http://citrix.com/download">DOWNLOADS</a></li>-->
			</ul>

		</div>
	</div>
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="./search.html" method="get">
	<i class="fa fa-search"></i>
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <ul class="current">
          
            <li>
    <li class="toctree-l1 current">
        <span class="expli"><i class="fa fa-plus-square-o" aria-hidden="true"></i></span><a class="current" style="width:250px;" href=".">Overview</a>
        
            <ul style="display:none">
            
                <li class="toctree-l3"><a href="#xenapp-and-xendesktop-sdk">XenApp and XenDesktop SDK</a></li>
                
                    <li><a class="toctree-l4" href="#key-differences-between-the-xendesktop-5-and-xendesktop-7-sdk">Key differences between the XenDesktop 5 and XenDesktop 7 SDK</a></li>
                
                    <li><a class="toctree-l4" href="#differences-in-policy-rules">Differences in policy rules</a></li>
                
                    <li><a class="toctree-l4" href="#use-the-sdk">Use the SDK</a></li>
                
                    <li><a class="toctree-l4" href="#group-policy-sdk-usage">Group Policy SDK usage</a></li>
                
            
            </ul>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" style="width:250px;" href="understandxd/">Understanding the XenDesktop Administration Model</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" style="width:250px;" href="getstarted/">Getting Started Guide</a>
        
    </li>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Examples</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" style="width:250px;" href="example1/">Example Create a catalog</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" style="width:250px;" href="example2/">Example Create and configure a host</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" style="width:250px;" href="example3/">Example Create a PvD Desktop</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" style="width:250px;" href="example4/">Example Get load balancing information</a>
        
    </li>

        
    </ul>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      


      
      <div class="wy-nav-content">
        <div class="rst-content">
         <!-- <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".">Docs</a> &raquo;</li>
    
      
    
    <li>Overview</li>
    <li class="wy-breadcrumbs-aside">
      
        
          <a href="https://github.com/ajitchelat/AppDNA-SDK.git" class="icon icon-github"> Edit on GitHub</a>
        
      
    </li>
  </ul>
  <hr/>
</div> -->
          <div role="main">
            <div class="section">
             
                <h2 id="xenapp-and-xendesktop-sdk"><a class="toclink" href="#xenapp-and-xendesktop-sdk">XenApp and XenDesktop SDK</a></h2>
<p><span id="par_richtext" class="anchor"></span></p>
<p>XenApp and XenDesktop provide an SDK based on a number of Microsoft
Windows PowerShell version 3.0 snap-ins that allows you to perform the
same tasks as you would with the Citrix Studio console, together with
tasks you cannot do with Studio alone.</p>
<p>As from version 7.5,XenApp and XenDesktop share a unified architecture and management: the
FlexCast Management Architecture. This means that XenApp provides many
features previously only available in XenDesktop; elements of the SDK
that relate to common features therefore apply equally to both XenApp
and XenDesktop, even though the commands themselves refer only to
XenDesktop.</p>
<h3 id="key-differences-between-the-xendesktop-5-and-xendesktop-7-sdk"><a class="toclink" href="#key-differences-between-the-xendesktop-5-and-xendesktop-7-sdk">Key differences between the XenDesktop 5 and XenDesktop 7 SDK</a></h3>
<ul>
<li>
<p><strong>New high-level SDK</strong> — XenDesktop 7 provides a new high-level SDK
    that enables you to script and automate site creation and
    maintenance quickly and easily. The high-level SDK insulates you
    from much of the complexity of the low-level SDKs, such that you can
    create a new site simply by running two cmdlets.</p>
</li>
<li>
<p><strong>New low-level SDKs </strong>— Individual low-level SDKs are provided for
    the new XenDesktop 7 services, including a dedicated and enhanced
    SDK for the Delegated Administration Service (DAS), which was
    previously part of the Broker SDK in XenDesktop 5. There are also
    SDKs for new features including the Monitor Service, Environment
    Test, and Configuration Logging.</p>
</li>
<li>
<p><strong>Windows Server OS Machine catalogs and delivery groups</strong> — You can
    use the XenDesktop 7 SDK to deliver cost-effective applications and
    desktops hosted on server operating systems.</p>
</li>
<li>
<p><strong>Desktop OS Machine applications</strong> — Desktop OS Machine
    applications have changed significantly at the SDK level. If you
    have existing scripts for running applications on Desktop OSs, you
    will have to update these scripts for XenDesktop 7 as there is
    little backwards compatibility.</p>
</li>
<li>
<p><strong>Apply settings to machines in Delivery Groups</strong> — In XenDesktop 7,
    using configuration slots, you can apply settings to machines in a
    specific delivery group, rather than to all machines in a site. This
    enables you to configure, for a given delivery group, which settings
    apply to that group. A number of pre-defined configuration slots are
    provided that contain different types of settings, such as settings
    for StoreFront addresses for use with Receiver or App-V publishing
    server locations. You can use one collection of settings from a slot
    to affect only a particular delivery group, and a different
    collection of settings from the same slot to affect another
    delivery group. You can use names appropriate to your particular
    deployment; for example, "Sales Department policy."</p>
</li>
<li>
<p><strong>Catalog types replaced</strong> — In XenDesktop 7, catalog types have
    been replaced by catalogs with individual properties. However, for
    backwards compatibility, you can still use existing scripts that
    employ catalog types, such as single image (pooled) and thin
    clone (dedicated) etc., but internally these are converted into sets
    of properties.</p>
</li>
</ul>
<blockquote>
<p><strong>Caution: Backwards compatibility with XenDesktop 5 catalog types has
been maintained where possible and practicable. However, when writing
new scripts, do not use catalog types; instead, specify catalogs with
individual properties.</strong></p>
</blockquote>
<ul>
<li><strong>Desktop object replaced</strong> — In XenDesktop 5, the Desktop object is
    one of the main types of SDK object used in Broker SDK scripts. The
    Desktop object describes both the machine and the session on
    the machine. In XenDesktop 7, this object is replaced by the Session
    object and the Machine object, both of which have been expanded to
    do the work of the Desktop object. However, for backwards
    compatibility, you can still use existing scripts that employ the
    Desktop object.</li>
</ul>
<blockquote>
<p><strong>Caution: Backwards compatibility with XenDesktop 5 has been
maintained where possible and practicable. However, when writing new
scripts, do not use the Desktop object; instead, specify Session and
Machine objects.</strong></p>
</blockquote>
<h3 id="differences-in-policy-rules"><a class="toclink" href="#differences-in-policy-rules">Differences in policy rules</a></h3>
<p>There are differences between the SDK and the Studio console in terms of
policy rules. Entitlement and assignment policy rules are independent
entities in the SDK; in the console, these entities are not visible as
they are seamlessly merged with the Delivery Group. Also, access policy
rules are less restrictive in the SDK.</p>
<h3 id="use-the-sdk"><a class="toclink" href="#use-the-sdk">Use the SDK</a></h3>
<p>The SDK comprises of a number of PowerShell snap-ins installed
automatically by the installation wizard when you install the Controller
or Studio components.</p>
<p>To access and run the cmdlets:</p>
<p>1.Start a shell in PowerShell 3.0.</p>
<blockquote>
<p>To start a shell from the console, click <strong>Studio</strong>, select the
PowerShell tab, and click on <strong>Launch PowerShell</strong>.</p>
<p>You must run the shell or script using an identity that has Citrix
administration rights. Although members of the local administrators
group on the Controller automatically have full administrative
privileges to allow XenDesktop to be installed, Citrix recommends that
for normal operation, you create Citrix administrators with the
appropriate rights, rather than use the local administrators account.
If you are running Windows Server 2008, you must run the shell or
script as a Citrix administrator, and not as a member of the local
administrators group.</p>
</blockquote>
<p>2.To use SDK cmdlets within scripts, set the execution policy in PowerShell.</p>
<blockquote>
<p>For more information about PowerShell execution policy, see your
Microsoft documentation.</p>
</blockquote>
<p>3.Add the snap-ins you require into the PowerShell environment using
    the <strong>Add -PSSnapin</strong> command in the Windows PowerShell console. V1
    and V2 denote the version of the snap-in (XenDesktop 5 snap-ins are
    version 1; XenDesktop 7 snap-ins are version 2.). For example, type:</p>
<blockquote>
<p>Add-PSSnapin Citrix.ADIdentity.Admin.V2</p>
<p>To import all the cmdlets, type:</p>
<p>Add-PSSnapin Citrix.*.Admin.V*</p>
<p>After importing, you have access to the cmdlets and their associated
help.</p>
</blockquote>
<p>For an example of a typical use case, see <a href="./getstarted"><em>Get started with the
SDK</em></a>.</p>
<p><strong>Tip:</strong> For a complete listing of all help text for the cmdlets,
see <a href="http://docs.citrix.com/en-us/xenapp-and-xendesktop/7-6/cds-sdk-wrapper-rho/xad-commands.html"><em>PowerShell cmdlet
help</em></a>.</p>
<h3 id="group-policy-sdk-usage"><a class="toclink" href="#group-policy-sdk-usage">Group Policy SDK usage</a></h3>
<p>The Citrix Group Policy SDK allows you to display and configure Group
Policy settings and filters. It uses a PowerShell provider to create a
virtual drive that corresponds to the machine and user settings and
filters. The provider appears as an extension to New-PSDrive. To use the
Group Policy SDK, either Studio or the XenApp and XenDesktop SDK must be
installed.</p>
<p><strong>Adding the Group Policy SDK</strong></p>
<p>1.To add the Group Policy SDK, type:</p>
<div class="codehilite"><pre>Add-PSSnapin citrix.common.grouppolicy
</pre></div>


<p><br>        <br />
2.To access help, type:</p>
<div class="codehilite"><pre>help New-PSDrive -path localgpo:/
</pre></div>


<p><strong>Using the Group Policy SDK</strong></p>
<p>1.To create a virtual drive and load it with settings, type:</p>
<div class="codehilite"><pre>New-PSDrive &amp;lt;Standard Parameters&amp;gt; \[-PSProvider\]
CitrixGroupPolicy *-Controller* &amp;lt;string&amp;gt;
</pre></div>


<div class="codehilite"><pre>**New-PSDrive &amp;lt;Standard Parameters&amp;gt; \[-PSProvider\]
CitrixGroupPolicy ***-Controller*** &amp;lt;string&amp;gt;**
</pre></div>


<blockquote>
<p>where <em>-Controller</em> is the fully qualified domain name of a controller
in the site you want to connect to and load settings from.</p>
</blockquote>
              
               
            </div>
          </div>

        </div>
      </div>

    </section>

  </div>

<!--<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/ajitchelat/AppDNA-SDK.git" class="icon icon-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
      
        <span class="next"><a href="understandxd/">Next <i class="fa fa-angle-right"></i></a></span>
      
    </span>
	<div class="footer-right">
		<ul class="social-links">
			<li class="list-inline"><a href="https://twitter.com/citrix"><i class="fa fa-twitter"></i>@citrix</a></li>
			<li class="list-inline"><a href="mailto:support@citrix.com"><i class="fa fa-envelope-o"></i>support@citrix.com</a></li>
		</ul>
		<ul class="inner-pages">
			<li class="list-inline"><a href="http://citrix.com/about/legal">Privacy and Terms</li>
		</ul>
	</div>
</div>-->

</body>
</html>

<!--
MkDocs version : 0.16.0
Build Date UTC : 2016-11-09 13:41:00
-->
